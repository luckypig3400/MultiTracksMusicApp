<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>多音軌音樂播放器</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
<style>
  :root { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans"; }
  html,body { height:100%; margin:0; background:#fafafa; color:#111; }
  .app { height:100%; display:flex; flex-direction:column; position:relative; }

  /* 30% 名稱 / 封面 */
  #music-name {
    height:30%;
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    font-size:1.4rem;
    user-select:none;
    cursor:pointer;
    border-bottom:1px solid #e0e0e0;
    padding:12px;
    box-sizing:border-box;
  }

  /* 5% 進度 */
  #progress-container {
    height:5%;
    display:flex;
    align-items:center;
    padding:0 8px;
    gap:8px;
    box-sizing:border-box;
    border-bottom:1px solid #eaeaea;
  }
  #time-current, #time-total { width:10%; text-align:center; font-size:0.9rem; }
  #progress { width:80%; height:6px; }

  /* 25% 控制 */
  #controls {
    height:25%;
    display:flex;
    align-items:center;
    justify-content:space-around;
    gap:8px;
    box-sizing:border-box;
    border-bottom:1px solid #eaeaea;
  }
  #controls button {
    padding:10px 14px;
    font-size:1rem;
    border-radius:8px;
    border:1px solid #ccc;
    background:white;
    cursor:pointer;
  }

  /* 40% 音軌控制 */
  #volume-controls {
    height:40%;
    overflow-y:auto;
    padding:8px;
    box-sizing:border-box;
  }
  .volume-track {
    display:flex;
    align-items:center;
    gap:6px;
    margin-bottom:6px;
  }
  .volume-track .lbl { width:5%; min-width:40px; font-size:0.9rem; text-align:left; }
  .volume-track input[type="range"] { width:85%; }
  .volume-track input[type="number"] { width:10%; box-sizing:border-box; padding:4px; }

  /* folder chooser popup */
  #folder-chooser {
    position: absolute;
    z-index: 9999;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    background:white;
    padding:16px;
    border-radius:8px;
    box-shadow:0 8px 24px rgba(0,0,0,0.12);
    display:none;
    min-width:320px;
  }
  #folder-chooser p { margin:0 0 8px 0; }
  #folder-chooser input[type=file] { width:100%; }

  /* 小的閃爍樣式（透過 JS 切換背景顏色） */
  .progress-flash { background-color: rgba(255,0,0,0.6) !important; transition: background-color 0.1s; }

  /* small helper */
  .hidden { display:none !important; }
</style>
</head>
<body>
  <div class="app">
    <div id="music-name">尚未載入歌曲 - 請選擇音樂資料夾或至設定新增資料夾</div>

    <div id="progress-container">
      <div id="time-current">0:00</div>
      <input id="progress" type="range" min="0" max="100" value="0" />
      <div id="time-total">0:00</div>
    </div>

    <div id="controls">
      <button id="btn-playlist" title="播放清單"><i class="fa-solid fa-list-ul"></i></button>
      <button id="btn-random" title="隨機"><i class="fa-solid fa-shuffle"></i></button>
      <button id="btn-prev" title="上一首"><i class="fa-solid fa-backward-step"></i></button>
      <button id="btn-play" title="播放"><i class="fa-solid fa-pause"></i></button>
      <button id="btn-next" title="下一首"><i class="fa-solid fa-forward-step"></i></button>
      <button id="btn-repeat" title="重複"><i class="fa-solid fa-repeat"></i></button>
      <button id="btn-settings" title="設定"><i class="fa-solid fa-gear"></i></button>
    </div>

    <div id="volume-controls">
      <!-- 動態產生音軌控制 -->
    </div>

    <div id="folder-chooser" role="dialog" aria-modal="true">
      <p>首次使用請選擇一或多個音樂資料夾（會掃描資料夾內音訊檔案）</p>
      <input type="file" id="folder-input" webkitdirectory directory multiple />
      <div style="margin-top:8px; text-align:right;">
        <button id="folder-ok">關閉</button>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
  <script src="setting.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      ThemeManager.loadAndApplyTheme(); // 自動套用已儲存的主題設定
    });
  </script>

</body>
</html>
